{"title":"Docker","uid":"a48e6dda0c21e40880cba7e763278b04","slug":"docker","date":"2019-01-11T02:59:39.000Z","updated":"2023-03-04T14:51:24.693Z","comments":true,"path":"api/articles/docker.json","keywords":null,"cover":[],"content":"<h1 style=\"text-align:center\">Docker的安装与使用</h1>\n\n<span id=\"more\"></span>\n\n<h2 id=\"Docker安装\"><a href=\"#Docker安装\" class=\"headerlink\" title=\"Docker安装\"></a>Docker安装</h2><h3 id=\"安装链接：链接1-amp-emsp-链接2\"><a href=\"#安装链接：链接1-amp-emsp-链接2\" class=\"headerlink\" title=\"安装链接：链接1&amp;emsp;链接2\"></a>安装链接：<a href=\"https://docs.docker.com/install/linux/docker-ce/centos/\">链接1</a>&amp;emsp;<a href=\"https://www.runoob.com/docker/centos-docker-install.html\">链接2</a></h3><h2 id=\"Docker-阿里云镜像加速配置\"><a href=\"#Docker-阿里云镜像加速配置\" class=\"headerlink\" title=\"Docker_阿里云镜像加速配置\"></a>Docker_阿里云镜像加速配置</h2><ol>\n<li><p>打开阿里云容器镜像服务：<a href=\"https://cr.console.aliyun.com/cn-hangzhou/mirrors\">https://cr.console.aliyun.com/cn-hangzhou/mirrors</a></p>\n<p><img src=\"/post/docker/Docker_aliyun.png\" alt=\"Docker_aliyun\"></p>\n</li>\n<li><p>vim &#x2F;etc&#x2F;docker&#x2F;daemon.json</p>\n</li>\n<li><p>{<br>“registry-mirrors”: [“<a href=\"https://5wfalegv.mirror.aliyuncs.com\" ]\">https://5wfalegv.mirror.aliyuncs.com&quot;]</a><br>}</p>\n</li>\n<li><p>sudo systemctl daemon-reload</p>\n</li>\n<li><p>sudo systemctl restart docker</p>\n</li>\n</ol>\n<h2 id=\"镜像命令\"><a href=\"#镜像命令\" class=\"headerlink\" title=\"镜像命令\"></a>镜像命令</h2><ul>\n<li>docker images   列出本地主机上的镜像<ul>\n<li>-a 列出本地所有的镜像（含中间映像层）</li>\n<li>-q 只显示镜像ID</li>\n<li>–digests 显示镜像的摘要信息</li>\n<li>–no-trunc 显示完整的镜像信息</li>\n</ul>\n</li>\n<li>docker search<ul>\n<li>–no-trunc 显示完整的镜像描述</li>\n<li>-s 列出收藏数不小于指定值的镜像</li>\n<li>–automated 只列出automated build类型的镜像</li>\n</ul>\n</li>\n<li>docker pull  下载镜像</li>\n<li>docker rmi<ul>\n<li>删除单个 docker rmi -f 镜像ID</li>\n<li>删除多个 docker rmi -f 镜像名1：tag  镜像名2：tag</li>\n<li>删除全部 docker rmi -f $(docker images -qa)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"容器命令\"><a href=\"#容器命令\" class=\"headerlink\" title=\"容器命令\"></a>容器命令</h2><ul>\n<li><p>创建并启动容器\tdocker run [OPTIONS] images [COMMAND] [ARG…]</p>\n<ul>\n<li><p>OPTIONS说明</p>\n<ul>\n<li><p>–name&#x3D;”容器新名字”</p>\n</li>\n<li><p>-d 后台运行容器，并返回容器ID，也即启动守护式容器</p>\n</li>\n<li><p>-i 以交互模式运行容器，通常与-t同时使用</p>\n</li>\n<li><p>-t 为容器重新分配一个伪输入终端，通常与-i同时使用</p>\n</li>\n<li><p>-P 随机端口映射</p>\n</li>\n<li><p>-p 指定端口映射，有以下四种格式</p>\n<p>  ip:hostPort:containerPort</p>\n<p>  ip::containerPort</p>\n<p>  hostPort:containerPort</p>\n<p>  containerPort</p>\n</li>\n</ul>\n</li>\n<li><p>列出当前所有正在运行的容器  docker ps[OPTIONS]</p>\n<ul>\n<li>-a 列出当前正在运行的容器和历史运行容器</li>\n<li>-l 显示最近创建的容器</li>\n<li>-n 显示最近n个创建的容器</li>\n<li>-q 显示容器编号</li>\n<li>–no-trunc 不截断输出</li>\n</ul>\n</li>\n<li><p>退出容器 exit 容器停止退出    ctrl+P+Q 容器不停止退出</p>\n</li>\n<li><p>重启容器  docker restart 容器名|容器ID</p>\n</li>\n<li><p>停止容器  docker stop 容器名|容器ID</p>\n</li>\n<li><p>强制停止容器 docker kill 容器名|容器ID</p>\n</li>\n<li><p>删除已停止的容器 docker rm 容器ID</p>\n</li>\n<li><p>启动守护式容器  docker run -d 容器名</p>\n</li>\n<li><p>查看容器日志  docker logs -f -t –tail  容器ID</p>\n<ul>\n<li>-t 是加入时间戳</li>\n<li>-f 跟随最新的日志打印</li>\n<li>–tail 数字显示最后多少条</li>\n</ul>\n</li>\n<li><p>查看正在运行的进程 docker top 容器ID</p>\n</li>\n<li><p>查看容器内部细节 docker inspect 容器ID</p>\n</li>\n<li><p>进入正在运行的容器并以命令行交互</p>\n<ul>\n<li>docker exec -it 容器ID bashShell<br>（例：docker exec -it 6ef2868b0e41 &#x2F;bin&#x2F;bash）<br>exec 在容器中打开新的终端，并且可以启动新的进程</li>\n<li>docker attach 容器ID  attach 直接进入容器启动命令的终端，不会启动新的进程</li>\n</ul>\n</li>\n<li><p>Docker镜像commoit操作补充  docker commit -m&#x3D;”提交的描述信息” -a&#x3D;”作者” 容器ID 要创建的目标镜像名:[标签名]</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"容器数据卷\"><a href=\"#容器数据卷\" class=\"headerlink\" title=\"容器数据卷\"></a>容器数据卷</h2><ul>\n<li><p>直接命令添加\t\t</p>\n<ul>\n<li>docker run -it -v &#x2F;宿主机绝对路径:&#x2F;容器内目录  镜像名</li>\n<li>(带权限) docker run -it -v &#x2F;宿主机绝对路径:&#x2F;容器内目录:ro  镜像名</li>\n</ul>\n</li>\n<li><p>DockerFile添加</p>\n<ul>\n<li><p>File构建</p>\n</li>\n<li><p>build后生成镜像 docker build -f  &#x2F;dockerfile文件路径 -t 命名 .</p>\n</li>\n<li><p>run容器</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"DockerFile解析\"><a href=\"#DockerFile解析\" class=\"headerlink\" title=\"DockerFile解析\"></a>DockerFile解析</h2><ul>\n<li><p>DockerFile体系结构</p>\n<ul>\n<li>FROM                 基础镜像，当前镜像是基于哪个镜像的</li>\n<li>MAINTAINER   镜像维护者的姓名和邮箱地址</li>\n<li>RUN                    容器构建时需要运行的命令</li>\n<li>EXPOSE             当前容器对外暴露出的端口</li>\n<li>WORKDIR         指定在创建容器后，终端默认登录的竟来工作目录</li>\n<li>ENV                    用来构建镜像过程中设置环境变量</li>\n<li>ADD                    将宿主机目录下的文件拷贝到镜像且ADD命令会自动处理URL和解压tar压缩包</li>\n<li>COPY                  类似ADD,拷贝文件个目录到镜像中。将从构建上下而我呢目录中&lt;源路径&gt;的文件&#x2F;目录复制到新的一层的镜像内的&lt;目标路径&gt;位置。</li>\n<li>VOLUME            容器数据卷，用于数据保存个持久化工作</li>\n<li>CMD                    指定一个容器启动时要运行的命令。DockerFile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换</li>\n<li>ENTRYPOINT    指定一个容器启动时要运行的命令。ENTRYPOINT和CMD一样，都是在指定容器启动程序及参数</li>\n<li>ONBUILD           当构建一个被继承的Dockerfile时运行命令，父镜像在被子镜像继承后父镜像的onbuild被触发。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"将本地镜像推送到阿里云\"><a href=\"#将本地镜像推送到阿里云\" class=\"headerlink\" title=\"将本地镜像推送到阿里云\"></a>将本地镜像推送到阿里云</h2><ul>\n<li><p>创建镜像仓库</p>\n<p><img src=\"/post/docker/push_docker.png\" alt=\"push_docker\"></p>\n</li>\n<li><p>将镜像推送到registry​\t</p>\n<pre class=\"line-numbers language-linux\" data-language=\"linux\"><code class=\"language-linux\">$ sudo docker login --username&#x3D;suvwwg registry.cn-hangzhou.aliyuncs.com\n$ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com&#x2F;wwg&#x2F;mytomcat:[镜像版本号]\n$ sudo docker push registry.cn-hangzhou.aliyuncs.com&#x2F;wwg&#x2F;mytomcat:[镜像版本号]</code></pre></li>\n</ul>\n<p>​    </p>\n<p>  ​\t\t  \t\t</p>\n","text":"Docker的安装与使用 Docker安装安装链接：链接1&amp;emsp;链接2Docker_阿里云镜像加速配置 打开阿里云容器镜像服务：https://cr.console.aliyun.com/cn-hangzhou/mirrors vim &#x2F;etc&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"linux","slug":"linux","count":1,"path":"api/categories/linux.json"}],"tags":[{"name":"虚拟化","slug":"虚拟化","count":1,"path":"api/tags/虚拟化.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">Docker的安装与使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Docker%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">Docker安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E9%93%BE%E6%8E%A5%EF%BC%9A%E9%93%BE%E6%8E%A51-amp-emsp-%E9%93%BE%E6%8E%A52\"><span class=\"toc-text\">安装链接：链接1&amp;emsp;链接2</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Docker-%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">Docker_阿里云镜像加速配置</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">镜像命令</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">容器命令</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7\"><span class=\"toc-text\">容器数据卷</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#DockerFile%E8%A7%A3%E6%9E%90\"><span class=\"toc-text\">DockerFile解析</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B0%86%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F%E6%8E%A8%E9%80%81%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91\"><span class=\"toc-text\">将本地镜像推送到阿里云</span></a></li></ol></li></ol>","author":{"name":"云の博客","slug":"blog-author","avatar":"/images/headImg.jpg","link":"/","description":"逆水行舟，不进则退","socials":{"github":"https://github.com/wangwengang","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/6235839578","zhihu":"https://www.zhihu.com/people/wang-wen-gang-88","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/bilibili.png","link":"https://space.bilibili.com/300075036?spm_id_from=333.1007.0.0"},"yuque":{"icon":"/images/yuque.png","link":"https://www.yuque.com/dashboard"},"youdaoyun":{"icon":"/images/youdaoyun.png","link":"https://note.youdao.com/web/#/file/recent/markdown/4B759CCEDB274B9B80BDAE364F584C9F/"},"email":{"icon":"/images/qq.png","link":"https://mail.qq.com/cgi-bin/frame_html?sid=7tWo2bVJUQoIWRJ2&r=fcc05bd806b6e9cb755f4c2f3c41763d&lang=zh"},"163邮箱":{"icon":"/images/163.png","link":"https://mail.163.com/js6/main.jsp?sid=XDgrOFUiTMnRnvpgWmiiQvyDkcaqoolS&df=email163#module=welcome.WelcomeModule%7C%7B%7D"}}}},"mapped":true,"prev_post":{"title":"SpringCloud","uid":"2fdfe1e1ace8a4912a23a4cbc1c92824","slug":"springcloud","date":"2019-01-14T11:38:48.000Z","updated":"2023-03-04T15:34:00.672Z","comments":true,"path":"api/articles/springcloud.json","keywords":null,"cover":null,"text":"SpringCloud微服务 关于微服务 SpringCloud和SpringBoot的关系SpringBoot专注于方便快速的开发单个个体的微服务 SpringCloud关注全局的微服务协调治理框架，它将SpringBoot开发的一个个单体微服务整合并管理起来，为各个微服务之间...","link":"","photos":[],"count_time":{"symbolsCount":887,"symbolsTime":"1 mins."},"categories":[{"name":"java","slug":"java","count":3,"path":"api/categories/java.json"}],"tags":[{"name":"Spring","slug":"Spring","count":2,"path":"api/tags/Spring.json"},{"name":"SpringCloud","slug":"SpringCloud","count":1,"path":"api/tags/SpringCloud.json"}],"author":{"name":"云の博客","slug":"blog-author","avatar":"/images/headImg.jpg","link":"/","description":"逆水行舟，不进则退","socials":{"github":"https://github.com/wangwengang","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/6235839578","zhihu":"https://www.zhihu.com/people/wang-wen-gang-88","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/bilibili.png","link":"https://space.bilibili.com/300075036?spm_id_from=333.1007.0.0"},"yuque":{"icon":"/images/yuque.png","link":"https://www.yuque.com/dashboard"},"youdaoyun":{"icon":"/images/youdaoyun.png","link":"https://note.youdao.com/web/#/file/recent/markdown/4B759CCEDB274B9B80BDAE364F584C9F/"},"email":{"icon":"/images/qq.png","link":"https://mail.qq.com/cgi-bin/frame_html?sid=7tWo2bVJUQoIWRJ2&r=fcc05bd806b6e9cb755f4c2f3c41763d&lang=zh"},"163邮箱":{"icon":"/images/163.png","link":"https://mail.163.com/js6/main.jsp?sid=XDgrOFUiTMnRnvpgWmiiQvyDkcaqoolS&df=email163#module=welcome.WelcomeModule%7C%7B%7D"}}}}},"next_post":{}}